<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chisato TikTok Downloader</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="particles" id="particles-js"></div>

  <!-- Welcome Modal -->
  <div id="welcomeModal" class="fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50">
    <div class="bg-[#1f2937] text-white p-6 rounded-2xl shadow-2xl max-w-sm w-full animate-fade-in text-center relative overflow-hidden border border-pink-500">
      <div class="absolute -top-10 -left-10 w-20 h-20 bg-pink-500 rounded-full filter blur-3xl opacity-20"></div>
      <div class="absolute -bottom-10 -right-10 w-20 h-20 bg-cyan-500 rounded-full filter blur-3xl opacity-20"></div>
      
      <img src="https://media1.tenor.com/m/65ImL18WPCMAAAAd/%E5%8D%83%E6%9D%9F.gif" alt="Chisato Greeting" class="rounded-lg mx-auto mb-4 shadow-lg border-2 border-pink-300 animate-float" />
      <h2 class="text-2xl font-bold text-pink-300 mb-2 neon-text">Creator @me_kyluesky~ üíñ</h2>
      <p class="text-sm text-gray-300 mb-4">Selamat datang di <span class="text-yellow-300 font-semibold neon-text">Chisato TikTok Downloader</span>!~ Yuk, mulai download video, slide, atau MP3 kesukaanmu. Jangan lupa senyum ya üí´</p>
      <button onclick="document.getElementById('welcomeModal').remove()" class="mt-2 px-4 py-2 bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 transition rounded-full text-sm font-medium shadow-lg btn-glow">
        üéÄ Baik, Chisato!
      </button>
    </div>
  </div>

  <!-- Main Container -->
  <div class="main-container">
    <!-- Header -->
    <div class="text-center">
      <h1 class="text-4xl md:text-5xl font-bold mb-2 bg-gradient-to-r from-cyan-400 via-pink-400 to-yellow-400 bg-clip-text text-transparent">
        Chisato TikTok Downloader
      </h1>
      <p class="text-gray-400">Download video, slide, dan audio dari TikTok dengan mudah!</p>
      
      <div class="flex justify-center space-x-4 mt-4">
        <a href="https://www.instagram.com/me_kyluesky" class="social-icon text-pink-400 hover:text-pink-300">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-instagram"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line></svg>
        </a>
        <a href="https://x.com/1kKyluesky">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
        </a>
        <a href="https://youtube.com/@kyluesky" class="social-icon text-yellow-400 hover:text-yellow-300">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-youtube"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg>
        </a>
      </div>
    </div>

    <!-- Content Wrapper -->
    <div class="content-wrapper space-y-8">
      <!-- TikTok Video Downloader -->
      <div class="glass-box text-center">
        <div class="flex items-center justify-center mb-4">
          <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-film text-cyan-400 mr-2"><rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18"></rect><line x1="7" y1="2" x2="7" y2="22"></line><line x1="17" y1="2" x2="17" y2="22"></line><line x1="2" y1="12" x2="22" y2="12"></line><line x1="2" y1="7" x2="7" y2="7"></line><line x1="2" y1="17" x2="7" y2="17"></line><line x1="17" y1="17" x2="22" y2="17"></line><line x1="17" y1="7" x2="22" y2="7"></line></svg>
          <h1 class="text-3xl neon-cyan neon-text">TikTok Video Downloader</h1>
        </div>
        <p class="text-sm text-gray-300 mb-4">Download video TikTok tanpa watermark dalam kualitas HD</p>
        <div class="relative">
          <input id="tiktokUrl" type="text" placeholder="üîó Tempelkan link TikTok..." class="w-full p-3 mb-4 rounded-lg border border-cyan-400 bg-white bg-opacity-5 text-white focus:outline-none input-field neon-cyan placeholder-cyan-400/50 pr-12" />
          <button onclick="pasteFromClipboard('tiktokUrl')" class="absolute right-2 top-2 bg-cyan-600 hover:bg-cyan-500 text-white px-3 py-1 rounded-md text-sm transition flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clipboard mr-1"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect></svg>
            Tempel
          </button>
        </div>
        <button onclick="downloadVideo()" class="w-full py-3 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 rounded-lg font-semibold btn-glow flex items-center justify-center">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-download mr-2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
          Download Video
        </button>
        <div id="result" class="mt-6"></div>
      </div>

      <!-- TikTok Slide Downloader -->
      <div class="glass-box text-center">
        <div class="flex items-center justify-center mb-4">
          <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-image text-pink-400 mr-2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg>
          <h2 class="text-2xl neon-pink neon-text">TikTok Slide Downloader</h2>
        </div>
        <p class="text-sm text-gray-300 mb-4">Download semua gambar dari slide TikTok secara manual</p>
        <div class="relative">
          <input id="slideUrl" type="text" placeholder="üîó Tempelkan link TikTok Slide..." class="w-full p-3 mb-4 rounded-lg border border-pink-400 bg-white bg-opacity-5 text-white focus:outline-none input-field neon-pink placeholder-pink-400/50 pr-12" />
          <button onclick="pasteFromClipboard('slideUrl')" class="absolute right-2 top-2 bg-cyan-600 hover:bg-cyan-500 text-white px-3 py-1 rounded-md text-sm transition flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clipboard mr-1"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect></svg>
            Tempel
          </button>
        </div>
        <button onclick="downloadSlide()" class="w-full py-3 bg-gradient-to-r from-pink-600 to-purple-600 hover:from-pink-500 hover:to-purple-500 rounded-lg font-semibold btn-glow flex items-center justify-center">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-download mr-2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
          Download Slide
        </button>
        <div id="slideResult" class="mt-6"></div>
      </div>

      <!-- TikTok MP3 Downloader -->
      <div class="glass-box text-center">
        <div class="flex items-center justify-center mb-4">
          <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-music text-yellow-400 mr-2"><path d="M9 18V5l12-2v13"></path><circle cx="6" cy="18" r="3"></circle><circle cx="18" cy="16" r="3"></circle></svg>
          <h2 class="text-2xl neon-yellow neon-text">TikTok MP3 Downloader</h2>
        </div>
        <p class="text-sm text-gray-300 mb-4">Ekstrak audio dari video TikTok dan simpan sebagai MP3</p>
        <div class="relative">
          <input id="mp3Url" type="text" placeholder="üîó Tempelkan link TikTok..." class="w-full p-3 mb-4 rounded-lg border border-yellow-400 bg-white bg-opacity-5 text-white focus:outline-none input-field neon-yellow placeholder-yellow-400/50 pr-12" />
          <button onclick="pasteFromClipboard('mp3Url')" class="absolute right-2 top-2 bg-cyan-600 hover:bg-cyan-500 text-white px-3 py-1 rounded-md text-sm transition flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clipboard mr-1"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect></svg>
            Tempel
          </button>
        </div>
        <button onclick="downloadMP3()" class="w-full py-3 bg-gradient-to-r from-yellow-600 to-orange-600 hover:from-yellow-500 hover:to-orange-500 rounded-lg font-semibold btn-glow flex items-center justify-center">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-download mr-2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
          Download MP3
        </button>
        <div id="mp3Result" class="mt-6"></div>
      </div>

      <!-- Kembali -->
      <div class="text-center">
        <a href="index.html" class="inline-block px-6 py-3 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-500 hover:to-blue-500 rounded-lg font-semibold shadow-lg btn-glow flex items-center justify-center">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left mr-2"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
          Kembali ke Beranda
        </a>
      </div>
    </div>
  </div>

  <script>
    // Particle effect
    function createParticles() {
      const container = document.getElementById('particles-js');
      const particleCount = 30;
      
      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.classList.add('particle');
        
        // Random size between 1px and 3px
        const size = Math.random() * 2 + 1;
        particle.style.width = `${size}px`;
        particle.style.height = `${size}px`;
        
        // Random position
        particle.style.left = `${Math.random() * 100}%`;
        particle.style.top = `${Math.random() * 100}%`;
        
        // Random animation
        const duration = Math.random() * 20 + 10;
        const delay = Math.random() * 5;
        particle.style.animation = `float ${duration}s ease-in-out ${delay}s infinite`;
        
        // Random opacity
        particle.style.opacity = Math.random() * 0.5 + 0.1;
        
        container.appendChild(particle);
      }
    }
    
    // Call particle function when page loads
    window.addEventListener('load', createParticles);

    // Function to paste from clipboard
    async function pasteFromClipboard(inputId) {
      try {
        const text = await navigator.clipboard.readText();
        document.getElementById(inputId).value = text;
        
        // Show success notification
        Swal.fire({
          icon: 'success',
          title: 'Link berhasil ditempel!',
          text: 'Tekan tombol download untuk melanjutkan',
          toast: true,
          position: 'top-end',
          showConfirmButton: false,
          timer: 2000,
          timerProgressBar: true,
          background: '#1f2937',
          color: '#fff'
        });
      } catch (err) {
        console.error('Failed to read clipboard contents: ', err);
        
        // Show error notification
        Swal.fire({
          icon: 'error',
          title: 'Gagal menempel link',
          text: 'Anda perlu memberikan izin akses clipboard',
          toast: true,
          position: 'top-end',
          showConfirmButton: false,
          timer: 3000,
          timerProgressBar: true,
          background: '#1f2937',
          color: '#fff'
        });
      }
    }

    function generateRandomFilename(ext = '.mp4') {
      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
      let name = '';
      for (let i = 0; i < 6; i++) {
        name += chars.charAt(Math.floor(Math.random() * chars.length));
      }
      return `chisato-${name}${ext}`;
    }

    async function downloadVideo() {
      const url = document.getElementById("tiktokUrl").value.trim();
      const resultBox = document.getElementById("result");
      if (!url.includes("tiktok.com")) {
        resultBox.innerHTML = `<div class="bg-red-900/30 border border-red-500 rounded-lg p-4 text-red-400 mt-4 animate__animated animate__headShake">‚ö†Ô∏è Link tidak valid</div>`;
        return;
      }
      resultBox.innerHTML = `<div class="bg-cyan-900/20 border border-cyan-500 rounded-lg p-4 text-cyan-300 animate-pulse flex items-center justify-center">
                              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-loader animate-spin mr-2"><line x1="12" y1="2" x2="12" y2="6"></line><line x1="12" y1="18" x2="12" y2="22"></line><line x1="4.93" y1="4.93" x2="7.76" y2="7.76"></line><line x1="16.24" y1="16.24" x2="19.07" y2="19.07"></line><line x1="2" y1="12" x2="6" y2="12"></line><line x1="18" y1="12" x2="22" y2="12"></line><line x1="4.93" y1="19.07" x2="7.76" y2="16.24"></line><line x1="16.24" y1="7.76" x2="19.07" y2="4.93"></line></svg>
                              Mengambil video...
                            </div>`;
      try {
        const res = await fetch(`https://tikwm.com/api/?url=${encodeURIComponent(url)}&hd=1`);
        const json = await res.json();
        if (!json.data?.play) throw new Error("Video tidak ditemukan.");
        const blob = await fetch(json.data.play).then(r => r.blob());
        const blobUrl = URL.createObjectURL(blob);
        const caption = json.data.title || "Tidak ada caption";
        const username = json.data.author?.unique_id || "Tidak diketahui";
        const link = document.createElement("a");
        link.href = blobUrl;
        link.download = generateRandomFilename('.mp4');
        document.body.appendChild(link); link.click(); document.body.removeChild(link);
        resultBox.innerHTML = `
          <div class="bg-cyan-900/20 border border-cyan-500 rounded-xl p-4 mt-4 animate__animated animate__fadeIn">
            <video controls autoplay class="w-full rounded-lg shadow-xl border border-cyan-300/50 mb-4">
              <source src="${blobUrl}" type="video/mp4">
            </video>
            <div class="text-left">
              <p class="text-sm text-cyan-200 italic mb-1">üìÑ Caption: ${caption}</p>
              <p class="text-sm text-yellow-200 italic mb-3">üë§ Creator: @${username}</p>
              <div class="flex items-center text-cyan-400">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-check-circle mr-2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
                Video berhasil diunduh!
              </div>
            </div>
          </div>`;
      } catch (err) {
        resultBox.innerHTML = `<div class="bg-red-900/30 border border-red-500 rounded-lg p-4 text-red-400 mt-4 animate__animated animate__headShake">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x-circle inline mr-2"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>
                                Gagal: ${err.message}
                              </div>`;
      }
    }

    async function downloadSlide() {
      const url = document.getElementById("slideUrl").value.trim();
      const box = document.getElementById("slideResult");
      if (!url.includes("tiktok.com")) {
        box.innerHTML = `<div class="bg-red-900/30 border border-red-500 rounded-lg p-4 text-red-400 mt-4 animate__animated animate__headShake">‚ö†Ô∏è Link tidak valid</div>`;
        return;
      }
      box.innerHTML = `<div class="bg-pink-900/20 border border-pink-500 rounded-lg p-4 text-pink-300 animate-pulse flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-loader animate-spin mr-2"><line x1="12" y1="2" x2="12" y2="6"></line><line x1="12" y1="18" x2="12" y2="22"></line><line x1="4.93" y1="4.93" x2="7.76" y2="7.76"></line><line x1="16.24" y1="16.24" x2="19.07" y2="19.07"></line><line x1="2" y1="12" x2="6" y2="12"></line><line x1="18" y1="12" x2="22" y2="12"></line><line x1="4.93" y1="19.07" x2="7.76" y2="16.24"></line><line x1="16.24" y1="7.76" x2="19.07" y2="4.93"></line></svg>
                        Mengambil slide...
                      </div>`;
      try {
        const res = await fetch(`https://tikwm.com/api/?url=${encodeURIComponent(url)}&hd=1`);
        const json = await res.json();
        if (!json.data?.images) throw new Error("Slide tidak ditemukan.");
        box.innerHTML = `<div class="bg-pink-900/20 border border-pink-500 rounded-xl p-4 mt-4 animate__animated animate__fadeIn">
                          <h3 class="text-pink-300 text-lg mb-4 flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-image mr-2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg>
                            ${json.data.images.length} Slide Ditemukan
                          </h3>
                          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            ${json.data.images.map((img, i) => `
                              <div class="bg-gray-800/50 rounded-lg overflow-hidden border border-pink-400/30">
                                <img src="${img}" class="w-full h-48 object-cover mb-2"/>
                                <a href="${img}" download="slide_${i + 1}.jpg" class="block py-2 bg-pink-600 hover:bg-pink-500 text-center text-white rounded-b-lg transition flex items-center justify-center">
                                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-download mr-2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                                  Download Slide ${i + 1}
                                </a>
                              </div>
                            `).join('')}
                          </div>
                        </div>`;
      } catch (err) {
        box.innerHTML = `<div class="bg-red-900/30 border border-red-500 rounded-lg p-4 text-red-400 mt-4 animate__animated animate__headShake">
                          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x-circle inline mr-2"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>
                          Gagal: ${err.message}
                        </div>`;
      }
    }

    async function downloadMP3() {
      const url = document.getElementById("mp3Url").value.trim();
      const box = document.getElementById("mp3Result");
      if (!url.includes("tiktok.com")) {
        box.innerHTML = `<div class="bg-red-900/30 border border-red-500 rounded-lg p-4 text-red-400 mt-4 animate__animated animate__headShake">‚ö†Ô∏è Link tidak valid</div>`;
        return;
      }
      box.innerHTML = `<div class="bg-yellow-900/20 border border-yellow-500 rounded-lg p-4 text-yellow-300 animate-pulse flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-loader animate-spin mr-2"><line x1="12" y1="2" x2="12" y2="6"></line><line x1="12" y1="18" x2="12" y2="22"></line><line x1="4.93" y1="4.93" x2="7.76" y2="7.76"></line><line x1="16.24" y1="16.24" x2="19.07" y2="19.07"></line><line x1="2" y1="12" x2="6" y2="12"></line><line x1="18" y1="12" x2="22" y2="12"></line><line x1="4.93" y1="19.07" x2="7.76" y2="16.24"></line><line x1="16.24" y1="7.76" x2="19.07" y2="4.93"></line></svg>
                        Mengambil audio...
                      </div>`;
      try {
        const res = await fetch(`https://tikwm.com/api/?url=${encodeURIComponent(url)}&hd=1`);
        const json = await res.json();
        if (!json.data?.music) throw new Error("Audio tidak ditemukan.");
        const blob = await fetch(json.data.music).then(r => r.blob());
        const blobUrl = URL.createObjectURL(blob);
        const link = document.createElement("a");
        link.href = blobUrl;
        link.download = generateRandomFilename('.mp3');
        document.body.appendChild(link); link.click(); document.body.removeChild(link);
        box.innerHTML = `
          <div class="bg-yellow-900/20 border border-yellow-500 rounded-xl p-4 mt-4 animate__animated animate__fadeIn">
            <div class="flex items-center justify-center mb-4">
              <audio controls class="w-full max-w-md">
                <source src="${blobUrl}" type="audio/mpeg">
              </audio>
            </div>
            <div class="flex items-center justify-center text-yellow-300">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-check-circle mr-2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
              MP3 berhasil diunduh!
            </div>
          </div>`;
      } catch (err) {
        box.innerHTML = `<div class="bg-red-900/30 border border-red-500 rounded-lg p-4 text-red-400 mt-4 animate__animated animate__headShake">
                          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x-circle inline mr-2"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>
                          Gagal: ${err.message}
                        </div>`;
      }
    }
  </script>
</body>
</html>
